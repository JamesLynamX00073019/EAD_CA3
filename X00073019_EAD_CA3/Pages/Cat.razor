@page "/cats"

<h3>Cat</h3>

@inject HttpClient Http

@*@<button class="btn btn-primary" @onclick="showKitty">Click for Cat!</button>*@
<button class="btn btn-primary" @onclick="GetDataAsync">Click for Cat!</button>





@if (data == null)
{
   <p><em>Loading...</em></p> }

else
{

    <img src="@data[0].url" alt="Meow" >
    
    // Template for search bar, not sure what to search for!
    <input @bind-value="SearchTerm" @bind-value:event="oninput" />

}


@code {
    public class Kitty
    {
        public List<object> breeds { get; set; }
        public string id { get; set; }
        public string url { get; set; }
        public int width { get; set; }
        public int height { get; set; }
    }

    // Deserialize to an Array
    private List<Kitty> data;

    public class Root
    {
        public List<Kitty> MyArray { get; set; }
    }

    // private Root data;
    private Boolean found;
    private string errormessage;
    private string breed;


    private string SearchTerm { get; set; } = "";


    private async Task GetDataAsync()
    {
        try
        {
            string uri = "https://api.thecatapi.com/v1/images/search";

            // Again, to an Array
            data = await Http.GetJsonAsync<List<Kitty>>(uri);

            found = true;
            errormessage = String.Empty;


        }
        catch (Exception e)
        {

            found = false;
            errormessage = e.Message;


        }
    }

    protected override async Task OnInitializedAsync()
    {
        await GetDataAsync();
    }


    // public string thisShouldShowACat;

    // private void showKitty()
    // {
    //     thisShouldShowACat = data.MyArray [0].url;
    //    Console.WriteLine(thisShouldShowACat);
    //
    //     await OnInitializedAsync();
    //   }




}
